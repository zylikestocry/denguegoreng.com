<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report Stagnant Water</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Report Stagnant Water</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="prevention.html">How to Prevent Dengue</a></li>
                <li><a href="clear-stagnant-water.html">Clear Stagnant Water</a></li>
                <li><a href="quiz.html">Quiz</a></li>
            </ul>
        </nav>
    </header>

    <section>
        <h2>Submit Your Report</h2>
        <p>Upload photos of stagnant water and its removal.</p>

        <form id="uploadForm" action="https://docs.google.com/forms/d/e/YOUR_FORM_ID/formResponse" method="POST" enctype="multipart/form-data">
            <label for="beforeImage">Before (Stagnant Water):</label><br>
            <input type="file" id="beforeImage" name="entry.YOUR_BEFORE_FIELD_ID" accept="image/*" required><br><br>

            <label for="afterImage">After (Cleared Water):</label><br>
            <input type="file" id="afterImage" name="entry.YOUR_AFTER_FIELD_ID" accept="image/*" required><br><br>

            <!-- Hidden Input to Store User ID -->
            <input type="hidden" id="userIDField" name="entry.YOUR_USERID_FIELD_ID">

            <button type="submit" id="submitButton" disabled>Submit</button>
        </form>
    </section>

    <footer>
        <p>Stay informed and take action. Together, we can fight dengue!</p>
    </footer>

    <!-- Load Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <!-- Load Firebase Configuration -->
    <script src="firebase-config.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
                .then(() => {
                    firebase.auth().onAuthStateChanged(user => {
                        const userIDField = document.getElementById("userIDField");
                        const submitButton = document.getElementById("submitButton");

                        if (user) {
                            console.log("User signed in:", user.uid);
                            userIDField.value = user.uid;
                            submitButton.disabled = false; // Enable form submission
                        } else {
                            console.warn("No user signed in");
                            userIDField.value = "";
                            submitButton.disabled = true; // Prevent submission
                            alert("You must be signed in to submit a report.");
                        }
                    });
                })
                .catch(error => console.error("Auth persistence error:", error));
        });
    </script>

</body>
</html>
